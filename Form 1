Imports System.Text

Public Class Form1
    'Version 1.07  3/31/2016

    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load


        Dim dir = ".\Database\"
        For Each DBfilelist As String In System.IO.Directory.GetFiles(dir)
            DBbox.Items.Add(System.IO.Path.GetFileNameWithoutExtension(DBfilelist))
        Next

        For i = 1 To 6

            If System.IO.File.Exists(".\txt\Name" & i & ".txt") Then
                Me.Controls("Name" & i).Text = Trim(My.Computer.FileSystem.ReadAllText(".\txt\Name" & i & ".txt"))
            End If

            If System.IO.File.Exists(".\txt\Title" & i & ".txt") Then
                Me.Controls("Title" & i).Text = Trim(My.Computer.FileSystem.ReadAllText(".\txt\Title" & i & ".txt"))
            End If

            If System.IO.File.Exists(".\txt\Phone" & i & ".txt") Then
                Me.Controls("Phone" & i).Text = Trim(My.Computer.FileSystem.ReadAllText(".\txt\Phone" & i & ".txt"))
            End If

            If System.IO.File.Exists(".\txt\email" & i & ".txt") Then
                Me.Controls("email" & i).Text = Trim(My.Computer.FileSystem.ReadAllText(".\txt\email" & i & ".txt"))
            End If

            If System.IO.File.Exists(".\txt\Website" & i & ".txt") Then
                Me.Controls("Website" & i).Text = Trim(My.Computer.FileSystem.ReadAllText(".\txt\Website" & i & ".txt"))
            End If

            If System.IO.File.Exists(".\txt\CityPhone" & i & ".txt") Then
                Me.Controls("CityPhone" & i).Text = Trim(My.Computer.FileSystem.ReadAllText(".\txt\CityPhone" & i & ".txt"))
            End If

            If System.IO.File.Exists(".\txt\CityWebsite" & i & ".txt") Then
                Me.Controls("CityWebsite" & i).Text = Trim(My.Computer.FileSystem.ReadAllText(".\txt\CityWebsite" & i & ".txt"))
            End If

        Next i


        If System.IO.File.Exists(".\txt\Producer1.txt") Then
            Producer1.Text = Trim(My.Computer.FileSystem.ReadAllText(".\txt\Producer1.txt"))
        End If

        If System.IO.File.Exists(".\txt\Host1.txt") Then
            Host1.Text = Trim(My.Computer.FileSystem.ReadAllText(".\txt\Host1.txt"))
        End If



        For i = 1 To 2

            If System.IO.File.Exists(".\txt\Director" & i & ".txt") Then
                Me.Controls("Director" & i).Text = Trim(My.Computer.FileSystem.ReadAllText(".\txt\Director" & i & ".txt"))
            End If

            If System.IO.File.Exists(".\txt\Graphics" & i & ".txt") Then
                Me.Controls("Graphics" & i).Text = Trim(My.Computer.FileSystem.ReadAllText(".\txt\Graphics" & i & ".txt"))
            End If

            If System.IO.File.Exists(".\txt\Audio" & i & ".txt") Then
                Me.Controls("Audio" & i).Text = Trim(My.Computer.FileSystem.ReadAllText(".\txt\Audio" & i & ".txt"))
            End If

        Next i



        For i = 1 To 3

            If System.IO.File.Exists(".\txt\Camera" & i & ".txt") Then
                Me.Controls("Camera" & i).Text = Trim(My.Computer.FileSystem.ReadAllText(".\txt\Camera" & i & ".txt"))
            End If

        Next i


        If System.IO.File.Exists(".\txt\NWCPphone.txt") Then
            NWCPphone.Text = Trim(My.Computer.FileSystem.ReadAllText(".\txt\NWCPphone.txt"))
        End If

        If System.IO.File.Exists(".\txt\CommentLine.txt") Then
            CommentLine.Text = Trim(My.Computer.FileSystem.ReadAllText(".\txt\CommentLine.txt"))
        End If

        If System.IO.File.Exists(".\txt\YouTube.txt") Then
            YouTube.Text = Trim(My.Computer.FileSystem.ReadAllText(".\txt\YouTube.txt"))
        End If

        Dim thisDate As Date
        thisDate = Today
        My.Computer.FileSystem.WriteAllText(".\txt\RecordDate.txt", thisDate, False)
        RecordDate.Text = My.Computer.FileSystem.ReadAllText(".\txt\RecordDate.txt")

        If System.IO.File.Exists(".\txt\ShowTitle.txt") Then
            ShowTitle.Text = Trim(My.Computer.FileSystem.ReadAllText(".\txt\ShowTitle.txt"))
        End If


    End Sub

    Private Sub ButtonSave_Click(sender As Object, e As EventArgs) Handles ButtonSave.Click

        For i = 1 To 6

            My.Computer.FileSystem.WriteAllText(".\txt\Name" & i & ".txt", Me.Controls("Name" & i).Text, False, Encoding.Default)
            If Me.Controls("Name" & i).Text = "" Then
                My.Computer.FileSystem.WriteAllText(".\txt\Name" & i & ".txt", "   ", False, Encoding.Default)
            End If

            My.Computer.FileSystem.WriteAllText(".\txt\Title" & i & ".txt", Me.Controls("Title" & i).Text, False, Encoding.Default)
            If Me.Controls("Title" & i).Text = "" Then
                My.Computer.FileSystem.WriteAllText(".\txt\Title" & i & ".txt", "   ", False, Encoding.Default)
            End If

            My.Computer.FileSystem.WriteAllText(".\txt\Phone" & i & ".txt", Me.Controls("Phone" & i).Text, False, Encoding.Default)
            If Me.Controls("Phone" & i).Text = "" Then
                My.Computer.FileSystem.WriteAllText(".\txt\Phone" & i & ".txt", "   ", False, Encoding.Default)
            End If

            My.Computer.FileSystem.WriteAllText(".\txt\email" & i & ".txt", Me.Controls("email" & i).Text, False, Encoding.Default)
            If Me.Controls("email" & i).Text = "" Then
                My.Computer.FileSystem.WriteAllText(".\txt\email" & i & ".txt", "   ", False, Encoding.Default)
            End If

            My.Computer.FileSystem.WriteAllText(".\txt\Website" & i & ".txt", Me.Controls("Website" & i).Text, False, Encoding.Default)
            If Me.Controls("Website" & i).Text = "" Then
                My.Computer.FileSystem.WriteAllText(".\txt\Website" & i & ".txt", "   ", False, Encoding.Default)
            End If

            My.Computer.FileSystem.WriteAllText(".\txt\CityPhone" & i & ".txt", Me.Controls("CityPhone" & i).Text, False, Encoding.Default)
            If Me.Controls("CityPhone" & i).Text = "" Then
                My.Computer.FileSystem.WriteAllText(".\txt\CityPhone" & i & ".txt", "   ", False, Encoding.Default)
            End If

            My.Computer.FileSystem.WriteAllText(".\txt\CityWebsite" & i & ".txt", Me.Controls("CityWebsite" & i).Text, False, Encoding.Default)
            If Me.Controls("CityWebsite" & i).Text = "" Then
                My.Computer.FileSystem.WriteAllText(".\txt\CityWebsite" & i & ".txt", "   ", False, Encoding.Default)
            End If

        Next i


        My.Computer.FileSystem.WriteAllText(".\txt\Producer1.txt", Producer1.Text, False, Encoding.Default)
        If Producer1.Text = "" Then
            My.Computer.FileSystem.WriteAllText(".\txt\Producer1.txt", "   ", False, Encoding.Default)
        End If

        My.Computer.FileSystem.WriteAllText(".\txt\Host1.txt", Host1.Text, False, Encoding.Default)
        If Host1.Text = "" Then
            My.Computer.FileSystem.WriteAllText(".\txt\Host1.txt", "   ", False, Encoding.Default)
        End If



        For i = 1 To 2

            My.Computer.FileSystem.WriteAllText(".\txt\Director" & i & ".txt", Me.Controls("Director" & i).Text, False, Encoding.Default)
            If Me.Controls("Director" & i).Text = "" Then
                My.Computer.FileSystem.WriteAllText(".\txt\Director" & i & ".txt", "   ", False, Encoding.Default)
            End If

            My.Computer.FileSystem.WriteAllText(".\txt\Graphics" & i & ".txt", Me.Controls("Graphics" & i).Text, False, Encoding.Default)
            If Me.Controls("Graphics" & i).Text = "" Then
                My.Computer.FileSystem.WriteAllText(".\txt\Graphics" & i & ".txt", "   ", False, Encoding.Default)
            End If

            My.Computer.FileSystem.WriteAllText(".\txt\Audio" & i & ".txt", Me.Controls("Audio" & i).Text, False, Encoding.Default)
            If Me.Controls("Audio" & i).Text = "" Then
                My.Computer.FileSystem.WriteAllText(".\txt\Audio" & i & ".txt", "   ", False, Encoding.Default)
            End If

        Next i

        For i = 1 To 3

            My.Computer.FileSystem.WriteAllText(".\txt\Camera" & i & ".txt", Me.Controls("Camera" & i).Text, False, Encoding.Default)
            If Me.Controls("Camera" & i).Text = "" Then
                My.Computer.FileSystem.WriteAllText(".\txt\Camera" & i & ".txt", "   ", False, Encoding.Default)
            End If

        Next i



        My.Computer.FileSystem.WriteAllText(".\txt\NWCPphone.txt", NWCPphone.Text, False, Encoding.Default)
        If NWCPphone.Text = "" Then
            My.Computer.FileSystem.WriteAllText(".\txt\NWCPphone.txt", "   ", False, Encoding.Default)
        End If

        My.Computer.FileSystem.WriteAllText(".\txt\CommentLine.txt", CommentLine.Text, False, Encoding.Default)
        If CommentLine.Text = "" Then
            My.Computer.FileSystem.WriteAllText(".\txt\CommentLine.txt", "   ", False, Encoding.Default)
        End If

        My.Computer.FileSystem.WriteAllText(".\txt\YouTube.txt", YouTube.Text, False, Encoding.Default)
        If YouTube.Text = "" Then
            My.Computer.FileSystem.WriteAllText(".\txt\YouTube.txt", "   ", False, Encoding.Default)
        End If

        My.Computer.FileSystem.WriteAllText(".\txt\RecordDate.txt", RecordDate.Text, False, Encoding.Default)
        If RecordDate.Text = "" Then
            My.Computer.FileSystem.WriteAllText(".\txt\RecordDate.txt", "   ", False, Encoding.Default)
        End If

        My.Computer.FileSystem.WriteAllText(".\txt\ShowTitle.txt", ShowTitle.Text, False, Encoding.Default)
        If ShowTitle.Text = "" Then
            My.Computer.FileSystem.WriteAllText(".\txt\ShowTitle.txt", "   ", False, Encoding.Default)
        End If



        If Trim(Director1.Text) <> "" And Trim(Director2.Text) <> "" Then
            My.Computer.FileSystem.WriteAllText(".\txt\DirectorHeader.txt", "Directors:", False, Encoding.Default)
        Else
            My.Computer.FileSystem.WriteAllText(".\txt\DirectorHeader.txt", "Director:", False, Encoding.Default)
        End If

        If Trim(Graphics1.Text) <> "" And Trim(Graphics2.Text) <> "" Then
            My.Computer.FileSystem.WriteAllText(".\txt\GraphicsHeader.txt", "Graphics Operators:", False, Encoding.Default)
        Else
            My.Computer.FileSystem.WriteAllText(".\txt\GraphicsHeader.txt", "Graphics Operator:", False, Encoding.Default)
        End If

        If Trim(Audio1.Text) <> "" And Trim(Audio2.Text) <> "" Then
            My.Computer.FileSystem.WriteAllText(".\txt\AudioHeader.txt", "Audio Operators:", False, Encoding.Default)
        Else
            My.Computer.FileSystem.WriteAllText(".\txt\AudioHeader.txt", "Audio Operator:", False, Encoding.Default)
        End If


        Dim CamVar As Integer
        CamVar = 0

        For i = 1 To 3
            If Trim(Me.Controls("Camera" & i).Text) <> "" Then
                CamVar = CamVar + 1
            End If
        Next i

        If CamVar > 1 Then
            My.Computer.FileSystem.WriteAllText(".\txt\CameraHeader.txt", "Camera Operators:", False, Encoding.Default)
        Else
            My.Computer.FileSystem.WriteAllText(".\txt\CameraHeader.txt", "Camera Operator:", False, Encoding.Default)
        End If



        Dim NameVar As Integer
        NameVar = 0

        For i = 1 To 6
            If Trim(Me.Controls("Name" & i).Text) <> "" Then
                NameVar = NameVar + 1
            End If
        Next i


        If NameVar > 1 Then
            My.Computer.FileSystem.WriteAllText(".\txt\NameHeader.txt", "Guests:", False, Encoding.Default)
        Else
            My.Computer.FileSystem.WriteAllText(".\txt\NameHeader.txt", "Guest:", False, Encoding.Default)
        End If



        MessageBox.Show("Files Saved to Graphics", "Northwest Community Politics",
           MessageBoxButtons.OK, MessageBoxIcon.Asterisk)
    End Sub

    Private Sub DBload_Click(sender As Object, e As EventArgs) Handles DBload.Click
        If DBbox.SelectedIndex > -1 Then

            Dim FileCount As Integer

            Dim FILE_NAME As String = ".\Database\" & DBbox.SelectedItem & ".txt"

            Dim TextLine(9) As String

            If System.IO.File.Exists(FILE_NAME) = True Then

                Dim objReader As New System.IO.StreamReader(FILE_NAME)

                Do While objReader.Peek() <> -1

                    TextLine(FileCount) = objReader.ReadLine()

                    FileCount = FileCount + 1
                Loop

                If DB1.Checked = True Then
                    Name1.Text = TextLine(0)
                    Title1.Text = TextLine(1)
                    Phone1.Text = TextLine(2)
                    email1.Text = TextLine(3)
                    Website1.Text = TextLine(4)
                    CityPhone1.Text = TextLine(5)
                    CityWebsite1.Text = TextLine(6)
                End If
                If DB2.Checked = True Then
                    Name2.Text = TextLine(0)
                    Title2.Text = TextLine(1)
                    Phone2.Text = TextLine(2)
                    email2.Text = TextLine(3)
                    Website2.Text = TextLine(4)
                    CityPhone2.Text = TextLine(5)
                    CityWebsite2.Text = TextLine(6)
                End If
                If DB3.Checked = True Then
                    Name3.Text = TextLine(0)
                    Title3.Text = TextLine(1)
                    Phone3.Text = TextLine(2)
                    email3.Text = TextLine(3)
                    Website3.Text = TextLine(4)
                    CityPhone3.Text = TextLine(5)
                    CityWebsite3.Text = TextLine(6)
                End If
                If DB4.Checked = True Then
                    Name4.Text = TextLine(0)
                    Title4.Text = TextLine(1)
                    Phone4.Text = TextLine(2)
                    email4.Text = TextLine(3)
                    Website4.Text = TextLine(4)
                    CityPhone4.Text = TextLine(5)
                    CityWebsite4.Text = TextLine(6)
                End If
                If DB5.Checked = True Then
                    Name5.Text = TextLine(0)
                    Title5.Text = TextLine(1)
                    Phone5.Text = TextLine(2)
                    email5.Text = TextLine(3)
                    Website5.Text = TextLine(4)
                    CityPhone5.Text = TextLine(5)
                    CityWebsite5.Text = TextLine(6)
                End If
                If DB6.Checked = True Then
                    Name6.Text = TextLine(0)
                    Title6.Text = TextLine(1)
                    Phone6.Text = TextLine(2)
                    email6.Text = TextLine(3)
                    Website6.Text = TextLine(4)
                    CityPhone6.Text = TextLine(5)
                    CityWebsite6.Text = TextLine(6)
                End If
                objReader.Close()
            End If
        End If
    End Sub

    Private Sub Clear_Click(sender As Object, e As EventArgs) Handles Clear.Click

        If DB1.Checked = True Then
            Name1.Text = ""
            Title1.Text = ""
            Phone1.Text = ""
            email1.Text = ""
            Website1.Text = ""
            CityPhone1.Text = ""
            CityWebsite1.Text = ""
        End If
        If DB2.Checked = True Then
            Name2.Text = ""
            Title2.Text = ""
            Phone2.Text = ""
            email2.Text = ""
            Website2.Text = ""
            CityPhone2.Text = ""
            CityWebsite2.Text = ""
        End If
        If DB3.Checked = True Then
            Name3.Text = ""
            Title3.Text = ""
            Phone3.Text = ""
            email3.Text = ""
            Website3.Text = ""
            CityPhone3.Text = ""
            CityWebsite3.Text = ""
        End If
        If DB4.Checked = True Then
            Name4.Text = ""
            Title4.Text = ""
            Phone4.Text = ""
            email4.Text = ""
            Website4.Text = ""
            CityPhone4.Text = ""
            CityWebsite4.Text = ""
        End If
        If DB5.Checked = True Then
            Name5.Text = ""
            Title5.Text = ""
            Phone5.Text = ""
            email5.Text = ""
            Website5.Text = ""
            CityPhone5.Text = ""
            CityWebsite5.Text = ""
        End If
        If DB6.Checked = True Then
            Name6.Text = ""
            Title6.Text = ""
            Phone6.Text = ""
            email6.Text = ""
            Website6.Text = ""
            CityPhone6.Text = ""
            CityWebsite6.Text = ""
        End If


    End Sub

    Private Sub SaveDB_Click(sender As Object, e As EventArgs) Handles SaveDB.Click

        Dim TextLine(9) As String

        If DB1.Checked = True Then
            TextLine(0) = Name1.Text
            TextLine(1) = Title1.Text
            TextLine(2) = Phone1.Text
            TextLine(3) = email1.Text
            TextLine(4) = Website1.Text
            TextLine(5) = CityPhone1.Text
            TextLine(6) = CityWebsite1.Text
        End If
        If DB2.Checked = True Then
            TextLine(0) = Name2.Text
            TextLine(1) = Title2.Text
            TextLine(2) = Phone2.Text
            TextLine(3) = email2.Text
            TextLine(4) = Website2.Text
            TextLine(5) = CityPhone2.Text
            TextLine(6) = CityWebsite2.Text
        End If
        If DB3.Checked = True Then
            TextLine(0) = Name3.Text
            TextLine(1) = Title3.Text
            TextLine(2) = Phone3.Text
            TextLine(3) = email3.Text
            TextLine(4) = Website3.Text
            TextLine(5) = CityPhone3.Text
            TextLine(6) = CityWebsite3.Text
        End If
        If DB4.Checked = True Then
            TextLine(0) = Name4.Text
            TextLine(1) = Title4.Text
            TextLine(2) = Phone4.Text
            TextLine(3) = email4.Text
            TextLine(4) = Website4.Text
            TextLine(5) = CityPhone4.Text
            TextLine(6) = CityWebsite4.Text
        End If
        If DB5.Checked = True Then
            TextLine(0) = Name5.Text
            TextLine(1) = Title5.Text
            TextLine(2) = Phone5.Text
            TextLine(3) = email5.Text
            TextLine(4) = Website5.Text
            TextLine(5) = CityPhone5.Text
            TextLine(6) = CityWebsite5.Text
        End If
        If DB6.Checked = True Then
            TextLine(0) = Name6.Text
            TextLine(1) = Title6.Text
            TextLine(2) = Phone6.Text
            TextLine(3) = email6.Text
            TextLine(4) = Website6.Text
            TextLine(5) = CityPhone6.Text
            TextLine(6) = CityWebsite6.Text
        End If


        If TextLine(0) <> "" Then
            System.IO.File.WriteAllLines(".\Database\" & TextLine(0) & ".txt", TextLine)

            DBbox.Items.Clear()

            Dim dir = ".\Database\"
            For Each DBfilelist As String In System.IO.Directory.GetFiles(dir)
                DBbox.Items.Add(System.IO.Path.GetFileNameWithoutExtension(DBfilelist))
            Next

            MessageBox.Show(TextLine(0) & " Saved to Database", "Northwest Community Politics",
   MessageBoxButtons.OK, MessageBoxIcon.Asterisk)
        End If

    End Sub


End Class
