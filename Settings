'Version 1.08  01/11/2017

Public Class Settings

    Dim FileCount As Integer
    Dim FILE_NAME As String = ".\txt\Settings.txt"
    Dim Fields = New String() {"Guest1", "Guest2", "Guest3", "Guest4", "Guest5", "Guest6", "Name", "Title", "Phone", "email", "Website", "Facebook", "Twitter", "YouTube", "CityPhone", "CityWebsite", "OfficePhone", "Officeemail", "Producer1", "Producer2", "Host1", "Host2", "Director1", "Director2", "Graphics1", "Graphics2", "Audio1", "Audio2", "Camera1", "Camera2", "Camera3", "Floor1", "Floor2", "Floor3", "CommentLine", "ShowPhone", "Showemail", "ShowWebsite", "ShowFacebook", "ShowTwitter", "ShowYouTube", "RecordDate", "ShowTitle"}

    Dim GBemailVal(6) As String

    Dim GBKeyString As String = ""

    Private Sub Settings_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        Dim TextLine As New List(Of String)
        If System.IO.File.Exists(FILE_NAME) = True Then
            Dim objReader As New System.IO.StreamReader(FILE_NAME)
            Do While objReader.Peek() <> -1
                TextLine.Add(objReader.ReadLine())
                FileCount = FileCount + 1
            Loop
            objReader.Close()

            If FileCount < Fields.Length Then
                For i = FileCount To Fields.Length - 1
                    TextLine.Add(1)
                Next i
            End If

            For i = 0 To Fields.length - 1
                If TextLine(i) = "1" Then
                    CType(Me.Controls.Item("Check" & Fields(i)), CheckBox).Checked = True
                End If
            Next i

        Else
            For i = 0 To Fields.Length - 1
                CType(Me.Controls.Item("Check" & Fields(i)), CheckBox).Checked = True
            Next i
        End If




    End Sub

    Public Sub LoadGBemail()
        Dim KeyFile As String = ".\txt\GraphicsBuilderKey.txt"
        If System.IO.File.Exists(KeyFile) = True Then
            GBKeyString = My.Computer.FileSystem.ReadAllText(KeyFile)
        End If



        'Load email values
        Dim GBeFILE_NAME As String = ".\txt\GraphicsBuilderemail.txt"
        Dim GBeTextLine As New List(Of String)
        Dim GBeCOUNT As Integer
        GBeCOUNT = 0
        If System.IO.File.Exists(GBeFILE_NAME) = True Then
            Dim GBeobjReader As New System.IO.StreamReader(GBeFILE_NAME)
            Do While GBeobjReader.Peek() <> -1
                GBeTextLine.Add(GBeobjReader.ReadLine())
                GBeCOUNT = GBeCOUNT + 1
            Loop
            GBeobjReader.Close()

            If GBeCOUNT > 5 Then
                Dim Off As Integer = 0
                For i = 0 To 5
                    GBemailVal(i) = Decryptemail(GBeTextLine(i), Off)
                    If i <> 3 Then
                        Me.Controls("GBemail" & i).Text = GBemailVal(i)
                    Else
                        Me.Controls("GBemail" & i).Text = "*****"
                    End If
                    Off = Off + 3
                Next i
            End If
        End If
    End Sub

    Private Sub ButtonSave_Click(sender As Object, e As EventArgs) Handles ButtonSave.Click
        Dim TextLine(50) As String
        For i = 0 To Fields.Length - 1
            If CType(Me.Controls.Item("Check" & Fields(i)), CheckBox).Checked = True Then
                TextLine(i) = 1
            Else
                TextLine(i) = 0
            End If
        Next i
        System.IO.File.WriteAllLines(FILE_NAME, TextLine)

        If GBemail0.Text <> "" And GBemail1.Text <> "" And GBemail2.Text <> "" And GBemail3.Text <> "" And GBemail4.Text <> "" And GBemail5.Text <> "" Then
            Dim Off As Integer = 0
            For i = 0 To 5
                If i <> 3 Then
                    GBemailVal(i) = Encryptemail(Me.Controls("GBemail" & i).Text, Off)
                Else
                    If Me.Controls("GBemail" & i).Text <> "*****" Then
                        GBemailVal(i) = Me.Controls("GBemail" & i).Text
                        Me.Controls("GBemail" & i).Text = "*****"
                    End If
                    GBemailVal(i) = Encryptemail(GBemailVal(i), Off)
                End If
                Off = Off + 3
            Next i
            System.IO.File.WriteAllLines(".\txt\GraphicsBuilderemail.txt", GBemailVal)
        End If

        If GBemail0.Text = "" And GBemail1.Text = "" And GBemail2.Text = "" And GBemail3.Text = "" And GBemail4.Text = "" And GBemail5.Text = "" Then
            My.Computer.FileSystem.DeleteFile(".\txt\GraphicsBuilderemail.txt")
        End If

        Me.Hide()
        Form1.FileCheck()
    End Sub




    Public Function Decryptemail(ByVal line As String, ByVal Offset As Integer)

        Dim CharArray() As Char = line.ToCharArray
        Dim GBKeyArray() As Char = GBKeyString.ToCharArray
        Dim DecyptString As String = ""

        Dim i As Integer = 0
        For Each element As Char In CharArray

            CharArray(i) = ChrW(Convert.ToInt32(CharArray(i)) - Convert.ToInt32(GBKeyArray(i + Offset)))
            DecyptString = DecyptString + CharArray(i)
            i = i + 1
        Next

        Return DecyptString
    End Function



    Public Function Encryptemail(ByVal line As String, ByVal Offset As Integer)

        Dim CharArray() As Char = line.ToCharArray
        Dim GBKeyArray() As Char = GBKeyString.ToCharArray
        Dim EncyptString As String = ""

        Dim i As Integer = 0
        For Each element As Char In CharArray

            CharArray(i) = ChrW(Convert.ToInt32(CharArray(i)) + Convert.ToInt32(GBKeyArray(i + Offset)))
            EncyptString = EncyptString + CharArray(i)
            i = i + 1
        Next

        Return EncyptString
    End Function

End Class
